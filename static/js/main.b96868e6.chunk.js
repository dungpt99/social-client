(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{123:function(e,t,a){},124:function(e,t,a){},125:function(e,t,a){},126:function(e,t,a){},127:function(e,t,a){},128:function(e,t,a){},129:function(e,t,a){},130:function(e,t,a){},131:function(e,t,a){},132:function(e,t,a){},133:function(e,t,a){},134:function(e,t,a){},135:function(e,t,a){},140:function(e,t,a){},141:function(e,t,a){"use strict";a.r(t);var c=a(1),s=a.n(c),r=a(78),n=a.n(r),i=a(4),o=a.n(i),l=a(6),u=a(7),j=a(149),p=a(152),d=a(153),b=(a(96),a(17)),h=function(e,t){switch(t.type){case"LOGIN_START":return{user:null,isFetching:!0,error:!1};case"LOGIN_SUCCESS":return{user:t.payload,isFetching:!1,error:!1};case"LOGIN_FAILURE":return{user:null,isFetching:!1,error:t.payload};default:return e}},O=a(0),m={user:null,isFetching:!1,error:!1},f=Object(c.createContext)(m),x=function(e){var t=e.children,a=Object(c.useReducer)(h,m),s=Object(u.a)(a,2),r=s[0],n=s[1];return Object(O.jsx)(f.Provider,{value:{user:r.user,isFetching:r.isFetching,error:r.error,dispatch:n},children:t})},v=a(5),g=a.n(v);function _(){var e=Object(c.useContext)(f).user,t=Object(c.useState)(),a=Object(u.a)(t,2),s=(a[0],a[1],function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return Object(O.jsxs)("div",{className:"topBar",children:[Object(O.jsx)("div",{className:"topBar__left",children:Object(O.jsx)(b.b,{to:"/",children:Object(O.jsx)("div",{className:"topBar__left-logo",children:"Social"})})}),Object(O.jsx)("div",{className:"topBar__center",children:Object(O.jsxs)("div",{className:"topBar__center-searchBar",children:[Object(O.jsx)(j.a,{className:"topBar__center-searchIcon"}),Object(O.jsx)("input",{type:"text",placeholder:"Search for friend, post or video",className:"topBar__center-searchInput",onChange:s})]})}),Object(O.jsxs)("div",{className:"topBar__right",children:[Object(O.jsx)(b.b,{to:"/profile/"+e.id,children:Object(O.jsxs)("div",{className:"topBar__right-user",children:[Object(O.jsx)("div",{className:"user__img",children:Object(O.jsx)("img",{src:e.avatar||"https://socialserver12-2021.herokuapp.com/assets/person/noavatar.png",className:"user__img-config",alt:""})}),Object(O.jsx)("div",{className:"user__name",children:e.name})]})}),Object(O.jsxs)("div",{className:"topBar__right-icon",children:[Object(O.jsx)(b.b,{to:"/messenger",style:{color:"#fff"},children:Object(O.jsxs)("div",{className:"topBar__right-iconItem",children:[Object(O.jsx)(p.a,{}),Object(O.jsx)("span",{className:"topBarIconBadge",children:"1"})]})}),Object(O.jsxs)("div",{className:"topBar__right-iconItem",children:[Object(O.jsx)(d.a,{}),Object(O.jsx)("span",{className:"topBarIconBadge",children:"1"})]})]})]})]})}var N=a(154),k=a(59);a(123);function w(e){var t=e.post,a=Object(c.useState)({}),s=Object(u.a)(a,2),r=s[0],n=s[1],i=Object(c.useState)(!1),j=Object(u.a)(i,2),p=j[0],d=j[1],h=Object(c.useState)(1),m=Object(u.a)(h,2),x=m[0],v=m[1],_=Object(c.useContext)(f).user,w="https://socialserver12-2021.herokuapp.com";Object(c.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("".concat(w,"/user/").concat(t.user.id));case 2:a=e.sent,n(a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t.user.id]),Object(c.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("".concat(w,"/like/").concat(t.id));case 2:a=e.sent,v(a.data.length);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t.id]);var y=function(){var e=Object(l.a)(o.a.mark((function e(){var a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=12;break}return e.prev=1,a={postId:t.id},e.next=5,g.a.post("".concat(w,"/like"),a);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:e.next=21;break;case 12:return e.prev=12,c={postId:t.id},e.next=16,g.a.delete("".concat(w,"/like"),{data:c});case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(12),console.log(e.t1);case 21:v(p?x-1:x+1),d(!p);case 23:case"end":return e.stop()}}),e,null,[[1,7],[12,18]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(O.jsx)("div",{className:"post",children:Object(O.jsxs)("div",{className:"postWrapper",children:[Object(O.jsxs)("div",{className:"postWrapper__top",children:[Object(O.jsxs)("div",{className:"postWrapper__topLeft",children:[Object(O.jsx)(b.b,{to:"/profile/"+r.id,children:Object(O.jsx)("img",{className:"postWrapper__topLeft-userImg",alt:"",src:r.avatar||w+"/assets/person/noavatar.png"})}),Object(O.jsxs)("div",{children:[Object(O.jsx)(b.b,{to:"/profile/"+r.id,children:Object(O.jsx)("div",{className:"postWrapper__topLeft-username",children:r.name})}),Object(O.jsx)("div",{className:"postWrapper__topLeft-time",children:Object(k.a)(t.createdAt)})]})]}),Object(O.jsx)("div",{className:"postWrapper__topRight",children:r.id===_.id&&Object(O.jsx)(N.a,{onClick:S})})]}),Object(O.jsxs)("div",{className:"postWrapper__center",children:[Object(O.jsx)("div",{className:"postWrapper__center-text",children:t.desc}),Object(O.jsx)("img",{src:w+t.img||"",alt:"",className:"postWrapper__center-img"})]}),Object(O.jsxs)("div",{className:"postWrapper__bottom",children:[Object(O.jsxs)("div",{className:"postWrapper__bottom-left",children:[Object(O.jsx)("img",{src:"/assets/post/heart.png",alt:"",onClick:y}),Object(O.jsxs)("span",{className:"left__likeCounter",children:[x," people liked it"]})]}),Object(O.jsx)("div",{className:"postWrapper__bottom-right",children:"10 comments"})]})]})})}var y=a(18),S=a(155),I=a(156),C=a(157),B=a(158),W=a(159);a(124);function E(e){var t,a=e.changeStatus,s=Object(c.useContext)(f).user,r=Object(c.useRef)(),n=Object(c.useState)(null),i=Object(u.a)(n,2),j=i[0],p=i[1],d="https://socialserver12-2021.herokuapp.com",b=function(){var e=Object(l.a)(o.a.mark((function e(t){var c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c={desc:r.current.value},!j){e.next=16;break}return(s=new FormData).append("file",j),s.append("desc",r.current.value),e.prev=6,e.next=9,g.a.post("".concat(d,"/post/uploads"),s);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),console.log(e.t0);case 14:e.next=24;break;case 16:return e.prev=16,e.next=19,g.a.post("".concat(d,"/post"),c);case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(16),console.log(e.t1);case 24:r.current.value=null,p(null),a(!0);case 27:case"end":return e.stop()}}),e,null,[[6,11],[16,21]])})));return function(t){return e.apply(this,arguments)}}();return Object(O.jsxs)("div",{className:"share",children:[Object(O.jsxs)("div",{className:"share__top",children:[Object(O.jsx)("div",{className:"share__top-img",children:Object(O.jsx)("img",{src:s.avatar||d+"/assets/person/noavatar.png",alt:""})}),Object(O.jsx)("input",{type:"text",className:"share__top-text",placeholder:"What are you thinking?",ref:r})]}),Object(O.jsx)("hr",{}),j&&Object(O.jsxs)("div",{className:"shareImgContainer",children:[Object(O.jsx)("img",(t={src:"shareImg"},Object(y.a)(t,"src",URL.createObjectURL(j)),Object(y.a)(t,"alt",""),t)),Object(O.jsx)(S.a,{className:"shareCancelImg",onClick:function(){return p(null)}})]}),Object(O.jsxs)("form",{className:"share__bottom",onSubmit:b,children:[Object(O.jsxs)("div",{className:"share__bottom-options",children:[Object(O.jsxs)("label",{htmlFor:"file",className:"share__bottom-option",children:[Object(O.jsx)(I.a,{className:"option__icon",htmlColor:"tomato"}),Object(O.jsx)("span",{className:"option__name",children:"Photo or video"}),Object(O.jsx)("input",{style:{display:"none"},type:"file",id:"file",accept:".png,.jpeg,.jpg",onChange:function(e){return p(e.target.files[0])}})]}),Object(O.jsxs)("div",{className:"share__bottom-option",children:[Object(O.jsx)(C.a,{className:"option__icon",htmlColor:"blue"}),Object(O.jsx)("span",{className:"option__name",children:"Tag"})]}),Object(O.jsxs)("div",{className:"share__bottom-option",children:[Object(O.jsx)(B.a,{className:"option__icon",htmlColor:"green"}),Object(O.jsx)("span",{className:"option__name",children:"Location"})]}),Object(O.jsxs)("div",{className:"share__bottom-option",children:[Object(O.jsx)(W.a,{className:"option__icon",htmlColor:"goldenrod"}),Object(O.jsx)("span",{className:"option__name",children:"Feeling"})]})]}),Object(O.jsx)("div",{className:"share__bottom-btn",children:Object(O.jsx)("button",{type:"submit",children:"Share"})})]})]})}a(125);function F(e){var t=e.userId,a=Object(c.useState)([]),s=Object(u.a)(a,2),r=s[0],n=s[1],i=Object(c.useContext)(f).user,j=Object(c.useState)(!1),p=Object(u.a)(j,2),d=p[0],b=p[1],h="https://socialserver12-2021.herokuapp.com";Object(c.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,g.a.get("".concat(h,"/post/profile/")+t);case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,g.a.get("".concat(h,"/post/timeline"));case 8:e.t0=e.sent;case 9:a=e.t0,n(a.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,d]);return Object(O.jsxs)("div",{className:"feed",children:[i.id===t||void 0===t?Object(O.jsx)(E,{changeStatus:function(e){b(e),setTimeout(b(!e),1e3)}}):null,r.map((function(e){return Object(O.jsx)(w,{post:e},e.id)}))]})}a(126);function L(){Object(c.useContext)(f).user;var e=Object(c.useState)([]),t=Object(u.a)(e,2),a=t[0],s=t[1],r="https://socialserver12-2021.herokuapp.com";return Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("".concat(r,"/user"));case 3:t=e.sent,s(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(O.jsxs)("div",{className:"rightBar",children:[Object(O.jsx)("div",{className:"rightBar__title",children:"People"}),Object(O.jsx)("ul",{className:"rightBar__friends",children:a.map((function(e){return Object(O.jsx)(b.b,{to:"/profile/"+e.id,style:{color:"#333"},user:e,children:Object(O.jsxs)("li",{className:"rightBar__friend",children:[Object(O.jsxs)("div",{className:"rightBar__friendImg",children:[Object(O.jsx)("img",{src:e.avatar||r+"/assets/person/noavatar.png",alt:""}),Object(O.jsx)("div",{className:"rightBar__friendStatus"})]}),Object(O.jsx)("span",{className:"rightBar__friendName",children:e.name})]})},e.id)}))})]})}a(127);var R=a(160);a(128);function T(){var e=Object(c.useContext)(f).user;return Object(O.jsx)("div",{className:"sideBar",children:Object(O.jsxs)("ul",{className:"sideBar__list",children:[Object(O.jsx)("li",{className:"sideBar__list-item",children:Object(O.jsx)(b.b,{to:"/profile/"+e.id,style:{width:"100%"},children:Object(O.jsxs)("div",{className:"item__user",children:[Object(O.jsx)("div",{className:"item__userImg",children:Object(O.jsx)("img",{src:e.avatar||"https://socialserver12-2021.herokuapp.com/assets/person/noavatar.png",alt:""})}),Object(O.jsx)("div",{className:"item__userName",children:e.name})]})})}),Object(O.jsxs)("li",{className:"sideBar__list-item",children:[Object(O.jsx)(R.a,{className:"item__icon"}),Object(O.jsx)("span",{className:"item__nameIcon",children:"New feed"})]})]})})}function U(){return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(_,{}),Object(O.jsxs)("div",{className:"homeContainer",children:[Object(O.jsx)(T,{}),Object(O.jsx)(F,{}),Object(O.jsx)(L,{})]})]})}a(129);var P=function(){var e=Object(l.a)(o.a.mark((function e(t,a){var c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:"LOGIN_START"}),e.prev=1,e.next=4,g.a.post("https://socialserver12-2021.herokuapp.com/login",t);case 4:return c=e.sent,localStorage&&(localStorage.setItem("accessToken",c.data.accessToken),localStorage.setItem("refreshToken",c.data.refreshToken)),g.a.interceptors.request.use((function(e){return e.headers.authorization="Bearer ".concat(c.data.accessToken),e}),(function(e){return Promise.reject(e)})),e.next=9,g.a.get("https://socialserver12-2021.herokuapp.com/user/current");case 9:s=e.sent,a({type:"LOGIN_SUCCESS",payload:s.data}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),a({type:"LOGIN_FAILURE",payload:e.t0});case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,a){return e.apply(this,arguments)}}();function A(){var e=Object(c.useRef)(),t=Object(c.useRef)(),a=Object(c.useContext)(f),s=(a.user,a.isFetching),r=(a.error,a.dispatch),n=function(){var a=Object(l.a)(o.a.mark((function a(c){return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:c.preventDefault(),P({email:e.current.value,password:t.current.value},r);case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return Object(O.jsx)("div",{className:"login",children:Object(O.jsxs)("div",{className:"loginWrapper",children:[Object(O.jsxs)("div",{className:"loginWrapper__left",children:[Object(O.jsx)("div",{className:"loginLogo",children:"Social"}),Object(O.jsx)("div",{className:"loginDesc",children:"Connect with friends and the world around on Social"})]}),Object(O.jsxs)("form",{className:"loginWrapper__right",onSubmit:n,children:[Object(O.jsxs)("div",{className:"loginWrapper__right-box",children:[Object(O.jsx)("input",{type:"email",className:"loginUsername",placeholder:"Email",ref:e}),Object(O.jsx)("input",{type:"password",className:"loginPassword",placeholder:"Password",ref:t})]}),Object(O.jsx)("div",{className:"loginWrapper__right-login",children:Object(O.jsx)("button",{type:"submit",disabled:s,children:"Login"})}),Object(O.jsx)("div",{className:"loginWrapper__right-forgot",children:Object(O.jsx)("span",{className:"forgotPassword",children:"Forgot Password?"})}),Object(O.jsx)("div",{className:"loginWrapper__right-create",children:Object(O.jsx)(b.b,{to:"/register",children:Object(O.jsx)("button",{children:"Create new account"})})})]})]})})}a(130);var D=a(9),G=a(161),q=a(162);function M(){var e=Object(c.useState)({}),t=Object(u.a)(e,2),a=t[0],s=t[1],r=Object(D.h)().id,n=Object(c.useContext)(f).user,i=Object(c.useState)(!1),j=Object(u.a)(i,2),p=j[0],d=j[1],b="https://socialserver12-2021.herokuapp.com";Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("".concat(b,"/friend"));case 3:e.sent.data.forEach((function(e){e.id===Number(r)&&d(!0)})),console.log(p),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}})()()}),[r]),Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("".concat(b,"/user/").concat(r));case 2:t=e.sent,s(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[r]);var h=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=12;break}return e.prev=1,e.next=4,g.a.post("".concat(b,"/friend"),{follow:r});case 4:e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:e.next=21;break;case 12:return e.prev=12,e.next=15,g.a.delete("".concat(b,"/friend"),{data:{follow:a.id}});case 15:e.sent,e.next=21;break;case 18:e.prev=18,e.t1=e.catch(12),console.log(e.t1);case 21:d(!p);case 22:case"end":return e.stop()}}),e,null,[[1,7],[12,18]])})));return function(){return e.apply(this,arguments)}}();return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(_,{}),Object(O.jsxs)("div",{className:"profileWrapper",children:[Object(O.jsxs)("div",{className:"profile__user",children:[Object(O.jsx)("img",{className:"profile__userCoverImg",src:a.coverImage||"/assets/person/cat.jpg",alt:""}),Object(O.jsxs)("div",{className:"profile__userAvt",children:[Object(O.jsx)("img",{src:a.avatar||b+"/assets/person/noavatar.png",alt:""}),Object(O.jsx)("div",{className:"profile__userName",children:a.name}),a.name!==n.name&&Object(O.jsxs)("button",{className:"profile__userFollow",onClick:h,children:[p?"Unfollow":"follow",p?Object(O.jsx)(G.a,{}):Object(O.jsx)(q.a,{})]})]})]}),Object(O.jsx)("div",{className:"profile__feed",children:Object(O.jsx)(F,{userId:a.id})})]})]})}a(131);function z(){var e=Object(c.useRef)(),t=Object(c.useRef)(),a=Object(c.useRef)(),s=Object(c.useRef)(),r=Object(D.g)(),n=function(){var c=Object(l.a)(o.a.mark((function c(n){var i;return o.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(n.preventDefault(),s.current.value===a.current.value){c.next=5;break}s.current.setCustomValidity("Password don't match"),c.next=15;break;case 5:return i={name:e.current.value,email:t.current.value,password:a.current.value},c.prev=6,c.next=9,g.a.post("".concat("https://socialserver12-2021.herokuapp.com","/user"),i);case 9:r.push("/login"),c.next=15;break;case 12:c.prev=12,c.t0=c.catch(6),console.log(c.t0);case 15:case"end":return c.stop()}}),c,null,[[6,12]])})));return function(e){return c.apply(this,arguments)}}();return Object(O.jsx)("div",{className:"register",children:Object(O.jsxs)("form",{className:"registerWrapper",onSubmit:n,children:[Object(O.jsx)("input",{type:"text",placeholder:"Name",required:!0,ref:e}),Object(O.jsx)("input",{type:"email",placeholder:"Email",required:!0,ref:t}),Object(O.jsx)("input",{type:"password",placeholder:"Password",required:!0,ref:a}),Object(O.jsx)("input",{type:"password",placeholder:"Repeat password",required:!0,ref:s}),Object(O.jsx)("div",{className:"registerWrapper__btn",children:Object(O.jsx)("button",{type:"submit",children:"Sign up"})})]})})}var J=a(164),V=a(31);a(132);function H(e){var t=e.userId,a=e.setCurrentChat,s=Object(c.useState)(null),r=Object(u.a)(s,2),n=r[0],i=r[1],j="https://socialserver12-2021.herokuapp.com";Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("".concat(j,"/user/")+t);case 3:a=e.sent,i(a.data),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[t]);return Object(O.jsx)("div",{className:"chatOnline",children:Object(O.jsxs)("div",{className:"chatOnlineFriend",onClick:function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("".concat(j,"/conversation/")+t);case 2:c=e.sent,a(c.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()},children:[Object(O.jsxs)("div",{className:"chatOnlineImgContainer",children:[Object(O.jsx)("img",{src:(null===n||void 0===n?void 0:n.avatar)||j+"/assets/person/noavatar.png",alt:"",className:"chatOnlineImg"}),Object(O.jsx)("div",{className:"chatOnlineBadge"})]}),Object(O.jsx)("div",{className:"chatOnlineName",children:null===n||void 0===n?void 0:n.name})]})})}a(133);function K(e){var t=e.conversation,a=e.currentUser,s=Object(c.useState)({}),r=Object(u.a)(s,2),n=r[0],i=r[1],j="https://socialserver12-2021.herokuapp.com";return Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("".concat(j,"/conversation/user/")+t.id);case 3:c=e.sent,s=c.data[0].users.find((function(e){return e.id!==a.id})),i(s),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}})()()}),[t,a]),Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("div",{className:"conversation",children:[Object(O.jsx)("img",{src:n.avatar||j+"/assets/person/noavatar.png",alt:"",className:"conversationImg"}),Object(O.jsx)("div",{className:"conversationName",children:n.name})]})})}a(134);function Q(e){var t=e.message,a=e.own,s=Object(c.useState)(null),r=Object(u.a)(s,2),n=(r[0],r[1]),i="https://socialserver12-2021.herokuapp.com";return Object(c.useEffect)((function(){t&&function(){var e=Object(l.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("".concat(i,"/user/")+t.user.id);case 3:a=e.sent,n(a.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}()()}),[t]),Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("div",{className:a?"message own":"message",children:[Object(O.jsxs)("div",{className:"message__top",children:[Object(O.jsx)("img",{src:t?i+"/assets/person/noavatar.png":"",alt:"",className:"messageImg"}),Object(O.jsx)("div",{className:"messageText",children:t?t.content:null})]}),Object(O.jsx)("div",{className:"message__bottom",children:t?Object(k.a)(t.createdAt):null})]})})}a(135);var X=a(86);function Y(){var e=Object(c.useState)([]),t=Object(u.a)(e,2),a=t[0],s=t[1],r=Object(c.useState)(null),n=Object(u.a)(r,2),i=n[0],j=n[1],p=Object(c.useState)(null),d=Object(u.a)(p,2),b=d[0],h=d[1],m=Object(c.useState)(""),x=Object(u.a)(m,2),v=x[0],N=x[1],k=Object(c.useState)(null),w=Object(u.a)(k,2),y=w[0],S=w[1],I=Object(c.useState)(null),C=Object(u.a)(I,2),B=C[0],W=C[1],E=Object(c.useState)(Object(X.a)("ws://socialsocketio122021.herokuapp.com")),F=Object(u.a)(E,2),L=F[0],R=(F[1],Object(c.useContext)(f).user),T=Object(c.useRef)(),U="https://socialserver12-2021.herokuapp.com";Object(c.useEffect)((function(){L.on("getMessage",(function(e){S({user:{id:e.senderId},content:e.content})}))}),[]),Object(c.useEffect)((function(){y&&h((function(e){return[].concat(Object(V.a)(e),[y])}))}),[y,i]),Object(c.useEffect)((function(){L.emit("addUser",R.id),L.on("getUser",(function(e){W(e)}))}),[]),Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("".concat(U,"/conversation"));case 2:t=e.sent,s(t.data),console.log(t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("".concat(U,"/messages/")+i.id);case 3:t=e.sent,h(t.data),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[i]);var P=function(){var e=Object(l.a)(o.a.mark((function e(t){var a,c,s,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,g.a.get("".concat(U,"/conversation/user/")+i.id);case 4:return a=e.sent,c=a.data[0].users.find((function(e){return e.id!==R.id})),L.emit("sendMessage",{senderId:R.id,receiverId:c.id,content:v}),s={content:v,receiverId:c.id},e.next=10,g.a.post("".concat(U,"/messages"),s);case 10:r=e.sent,h([].concat(Object(V.a)(b),[r.data])),N(""),e.next=17;break;case 15:e.prev=15,e.t0=e.catch(1);case 17:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){var e;null===(e=T.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[b]),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(_,{}),Object(O.jsxs)("div",{className:"messenger",children:[Object(O.jsx)("div",{className:"messenger__left",children:Object(O.jsxs)("div",{className:"messengerMenuWrapper",children:[Object(O.jsx)("input",{type:"text",placeholder:"Search for friend",className:"chatMenuInput"}),a.map((function(e){return Object(O.jsx)("div",{onClick:function(){return j(e)},children:Object(O.jsx)(K,{conversation:e,currentUser:R})},e.id)}))]})}),Object(O.jsx)("div",{className:"messenger__box",children:Object(O.jsx)("div",{className:"messengerBoxWrapper",children:i?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{className:"chatBoxTop",children:null!==b?b.map((function(e){return Object(O.jsx)("div",{ref:T,children:Object(O.jsx)(Q,{message:e,own:e.user.id===R.id})},e.id)})):Object(O.jsx)(Q,{})}),Object(O.jsxs)("div",{className:"chatBoxBottom",children:[Object(O.jsx)("textarea",{className:"chatMessageInput",onChange:function(e){return N(e.target.value)},value:v}),Object(O.jsx)("button",{className:"chatSubmitButton",onClick:P,children:"Send"})]})]}):Object(O.jsx)("span",{className:"noConversation",children:"Open conversation to start a chat"})})}),Object(O.jsx)("div",{className:"messenger__right",children:Object(O.jsxs)("div",{className:"messengerOnlineWrapper",children:["Online",null===B||void 0===B?void 0:B.map((function(e){return e.userId!==R.id?Object(O.jsx)(H,{userId:e.userId,setCurrentChat:j},e.userId):null}))]})})]})]})}var Z=function(){var e=Object(c.useContext)(f),t=e.user,a=e.dispatch;return Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(t=localStorage.getItem("accessToken"))&&g.a.interceptors.request.use((function(e){return e.headers.authorization="Bearer ".concat(t),e}),(function(e){return Promise.reject(e)})),e.next=5,g.a.get("https://socialserver12-2021.herokuapp.com/user/current");case 5:c=e.sent,a({type:"LOGIN_SUCCESS",payload:c.data}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(O.jsx)(b.a,{children:Object(O.jsxs)(D.d,{children:[Object(O.jsx)(D.b,{exact:!0,path:"/",children:t?Object(O.jsx)(U,{}):Object(O.jsx)(A,{})}),Object(O.jsx)(D.b,{exact:!0,path:"/register",children:Object(O.jsx)(z,{})}),Object(O.jsx)(D.b,{path:"/login",children:t?Object(O.jsx)(D.a,{to:"/"}):Object(O.jsx)(A,{})}),Object(O.jsx)(D.b,{path:"/profile/:id",children:t?Object(O.jsx)(M,{}):Object(O.jsx)(J.a,{})}),Object(O.jsx)(D.b,{path:"/messenger",children:Object(O.jsx)(Y,{})})]})})};a(140);n.a.render(Object(O.jsx)(s.a.StrictMode,{children:Object(O.jsx)(x,{children:Object(O.jsx)(Z,{})})}),document.getElementById("root"))},96:function(e,t,a){}},[[141,1,2]]]);
//# sourceMappingURL=main.b96868e6.chunk.js.map